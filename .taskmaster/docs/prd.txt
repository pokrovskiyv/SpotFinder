# Product Requirements Document (PRD)
## SpotFinder - Гиперлокальный AI-ассистент для поиска мест

**Версия:** 1.0  
**Дата:** Январь 2024  
**Статус:** Approved - Implementation Complete  
**Автор:** SpotFinder Team

---

## 1. Executive Summary

### 1.1 Описание продукта

SpotFinder - это интеллектуальный Telegram-бот, который помогает пользователям мгновенно находить нужные места рядом с их текущей локацией, используя естественный язык и AI-понимание намерений.

**Ключевое отличие:** Вместо традиционного поиска по категориям ("Кафе" → "Рестораны" → "Фильтры"), пользователь просто описывает свою потребность на естественном языке:
- "Промочил ноги" → Обувные магазины
- "Хочу поработать" → Кафе с Wi-Fi и тихой атмосферой
- "У меня сел телефон" → Места с розетками поблизости

### 1.2 Проблема

**Текущая ситуация:**
- Поиск мест требует навигации через множество меню и категорий
- Пользователи не всегда знают точное название категории
- Существующие решения не понимают контекст и намерения
- Нет персонализации на основе предпочтений

**Боль пользователя:**
- "Я не знаю, как называется то, что мне нужно"
- "Мне нужно срочно, некогда разбираться в интерфейсе"
- "Почему я не могу просто сказать, что мне нужно?"

### 1.3 Решение

AI-ассистент, который:
1. **Понимает естественный язык** - говори как с человеком
2. **Распознает намерения** - понимает неявные запросы
3. **Учитывает контекст** - время суток, срочность, погода
4. **Ведет диалог** - можно уточнять детали
5. **Персонализируется** - запоминает предпочтения

---

## 2. Бизнес-цели и метрики

### 2.1 Цели

**Краткосрочные (3 месяца):**
- Запустить MVP с 10+ активными пользователями
- Достичь 80%+ точности понимания запросов
- Время ответа < 5 секунд для 90% запросов

**Среднесрочные (6 месяцев):**
- 100+ активных пользователей
- Средняя retention 40%+ (WAU/MAU)
- 3+ запроса на пользователя в неделю

**Долгосрочные (12 месяцев):**
- 1000+ активных пользователей
- Монетизация (премиум подписка или реклама)
- Расширение на другие мессенджеры

### 2.2 Ключевые метрики успеха (KPI)

| Метрика | MVP | v1.1 | v2.0 |
|---------|-----|------|------|
| Accuracy (понимание запросов) | 80% | 85% | 90% |
| Response Time (p90) | <5 сек | <3 сек | <2 сек |
| Success Rate (успешных поисков) | 75% | 85% | 90% |
| Follow-up Rate (% уточнений) | 30% | 40% | 50% |
| User Satisfaction (1-5) | 4.0 | 4.3 | 4.5 |

---

## 3. Целевая аудитория

### 3.1 Primary Personas

#### Persona 1: "Активный горожанин" (Александр, 28 лет)
- **Профессия:** IT-специалист
- **Локация:** Москва
- **Поведение:** 
  - Часто работает из кафе
  - Ценит время
  - Использует Telegram как основной мессенджер
- **Потребности:**
  - Быстро найти место для работы
  - Wi-Fi и розетки обязательны
  - Не хочет тратить время на поиск

#### Persona 2: "Турист" (Мария, 35 лет)
- **Профессия:** Маркетолог
- **Локация:** Путешествует по России
- **Поведение:**
  - Часто в незнакомых городах
  - Ищет аутентичные места
  - Доверяет рекомендациям

#### Persona 3: "Родитель" (Екатерина, 32 года)
- **Профессия:** Менеджер
- **Локация:** Санкт-Петербург
- **Поведение:**
  - Часто с ребенком
  - Нужны специфичные условия (детская зона, пеленальный столик)
  - Планирует заранее

---

## 4. User Stories и Use Cases

### 4.1 Core User Stories (MVP)

**Epic 1: Поиск мест**

As a пользователь
I want to найти место, описав свою потребность на естественном языке
So that я могу быстро получить релевантные результаты без навигации по меню

**User Stories:**
1. US-001: Как пользователь, я хочу написать "найди кофейню" и получить список ближайших кофеен
2. US-002: Как пользователь, я хочу написать "промочил ноги" и получить обувные магазины
3. US-003: Как пользователь, я хочу написать "хочу поработать" и получить кафе с Wi-Fi
4. US-004: Как пользователь, я хочу получить информацию о месте (адрес, часы, рейтинг)
5. US-005: Как пользователь, я хочу построить маршрут до места одной кнопкой

**Epic 2: Контекстные диалоги**

As a пользователь
I want to уточнять детали о найденных местах
So that я могу получить именно ту информацию, которая мне нужна

**User Stories:**
1. US-010: Как пользователь, я хочу спросить "а у второго есть парковка?" после получения списка
2. US-011: Как пользователь, я хочу спросить "какой у первого рейтинг?"
3. US-012: Как пользователь, я хочу спросить "далеко ли третий?" и получить расстояние
4. US-013: Как пользователь, я хочу сравнить "что дешевле - первый или второй?"

**Epic 3: Персонализация**

As a пользователь
I want to чтобы бот запоминал мои предпочтения
So that я получал более релевантные результаты

**User Stories:**
1. US-020: Как веган, я хочу получать только места с веганскими опциями
2. US-021: Как пользователь, я хочу, чтобы бот помнил, что я предпочитаю тихие места
3. US-022: Как пользователь, я хочу сохранить домашний и рабочий адрес
4. US-023: Как пользователь, я хочу, чтобы бот учился из моих выборов

---

## 5. Функциональные требования

### 5.1 MVP Scope (v1.0)

#### 5.1.1 Обязательные функции

**F-001: Поиск по естественному языку**
- **Priority:** P0 (Must Have)
- **Description:** Пользователь может описать потребность на естественном языке
- **Acceptance Criteria:**
  - Поддержка запросов длиной до 200 символов
  - Понимание русского языка
  - Обработка опечаток и сокращений
  - Success rate >80% для базовых запросов

**F-002: Понимание неявных намерений**
- **Priority:** P0 (Must Have)
- **Description:** Система распознает неявные намерения
- **Examples:**
  - "Промочил ноги" → обувные магазины
  - "Заболел" → аптеки
  - "Сел телефон" → места с розетками
- **Acceptance Criteria:**
  - Accuracy >75% для 10 типичных неявных запросов
  - Fallback на уточняющий вопрос при неуверенности

**F-003: Управление геолокацией**
- **Priority:** P0 (Must Have)
- **Description:** Система запрашивает и валидирует геолокацию
- **Acceptance Criteria:**
  - Запрос геолокации при /start
  - TTL геолокации = 20 минут
  - Переспрос при устаревшей локации
  - Кнопка для быстрой отправки локации

**F-004: Контекстные уточнения**
- **Priority:** P0 (Must Have)
- **Description:** Пользователь может задавать уточняющие вопросы
- **Acceptance Criteria:**
  - Распознавание ссылок на предыдущие результаты ("первый", "второй", "у него")
  - Сохранение контекста диалога до 30 минут
  - Поддержка до 3 уровней вложенности диалога

**F-005: Inline кнопки для действий**
- **Priority:** P0 (Must Have)
- **Description:** Каждое место имеет кнопки действий
- **Buttons:**
  - "🗺 Показать на карте" → открывает Google Maps
  - "🚶 Как добраться" → построение маршрута
  - "ℹ️ Подробнее" → детальная информация
- **Acceptance Criteria:**
  - Кнопки работают во всех клиентах Telegram
  - Ссылки открываются корректно
  - Callback обрабатываются <1 сек

---

## 6. Технические требования

### 6.1 Technology Stack

**Backend:**
- Platform: Supabase Edge Functions (Deno runtime)
- Language: TypeScript
- Framework: Native Deno HTTP

**Database:**
- Primary: Supabase PostgreSQL 15
- Extensions: PostGIS для геопространственных запросов
- Cache: PostgreSQL tables (sessions, places_cache)

**AI/ML:**
- LLM: Google Gemini Pro с Maps Grounding
- Maps: Google Maps Platform (Places API New)

**Messaging:**
- Platform: Telegram Bot API
- Protocol: Webhook (HTTPS POST)

---

## 7. MVP Definition

### 7.1 In Scope

**✅ Включено в MVP:**
1. Поиск по естественному языку (5 категорий)
2. Понимание неявных намерений (10 типичных паттернов)
3. Контекстные уточнения (до 3 уровней)
4. Управление геолокацией с TTL
5. Inline кнопки для действий
6. Базовая персонализация (dietary restrictions)
7. Кэширование Places API результатов
8. Telegram команды: /start, /help, /location

**Метрики успеха MVP:**
- 10+ активных пользователей
- 80%+ accuracy понимания запросов
- <5 сек response time (p90)
- 70%+ успешных уточняющих вопросов

---

## 8. Roadmap

### Phase 1: MVP (v1.0) - ✅ COMPLETE
**Timeline:** Январь 2024 (4-6 недель)
**Focus:** Core functionality

**Deliverables:**
- ✅ Базовая архитектура
- ✅ 5 категорий мест
- ✅ Понимание намерений
- ✅ Контекстные диалоги
- ✅ Документация

### Phase 2: Optimization (v1.1)
**Timeline:** Февраль 2024 (2-3 недели)
**Focus:** Quality & Performance

**Deliverables:**
- [ ] Unit & Integration тесты
- [ ] Улучшенное кэширование (geo-hash)
- [ ] Analytics dashboard
- [ ] A/B тестирование промптов
- [ ] Performance optimization

### Phase 3: Expansion (v1.5)
**Timeline:** Март 2024 (3-4 недели)
**Focus:** User growth

**Deliverables:**
- [ ] 10 дополнительных категорий
- [ ] Расширенная персонализация
- [ ] Saved places (избранное)
- [ ] Sharing функции
- [ ] Referral program

