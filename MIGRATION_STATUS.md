# –°—Ç–∞—Ç—É—Å –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –º–∏–≥—Ä–∞—Ü–∏–π Supabase

**–î–∞—Ç–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏:** 27 –æ–∫—Ç—è–±—Ä—è 2025  
**–ü—Ä–æ–µ–∫—Ç:** SpotFinder (`icnnwmjrprufrohiyfpm`)

## ‚úÖ –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞

### –ß—Ç–æ –≥–æ—Ç–æ–≤–æ:

1. **–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Supabase**
   - ‚úÖ Project URL –Ω–∞—Å—Ç—Ä–æ–µ–Ω: `https://icnnwmjrprufrohiyfpm.supabase.co`
   - ‚úÖ –ö–ª—é—á–∏ API –≤–∞–ª–∏–¥–Ω—ã (ANON_KEY –∏ SERVICE_ROLE_KEY)
   - ‚úÖ MCP –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–∞ (`.cursor/mcp_config.json`)
   - ‚úÖ –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö —Ä–∞–±–æ—Ç–∞–µ—Ç

2. **–§–∞–π–ª—ã –º–∏–≥—Ä–∞—Ü–∏–π**
   - ‚úÖ `001_create_users_table.sql` - –≥–æ—Ç–æ–≤
   - ‚úÖ `002_create_sessions_table.sql` - –≥–æ—Ç–æ–≤
   - ‚úÖ `003_enable_postgis.sql` - –≥–æ—Ç–æ–≤
   - ‚úÖ `004_create_user_preferences_table.sql` - –≥–æ—Ç–æ–≤
   - ‚úÖ `005_create_search_history_table.sql` - –≥–æ—Ç–æ–≤
   - ‚úÖ `006_create_places_cache_table.sql` - –≥–æ—Ç–æ–≤

3. **–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã**
   - ‚úÖ –î–µ—Ç–∞–ª—å–Ω–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è —Å–æ–∑–¥–∞–Ω–∞: `APPLY_MIGRATIONS_INSTRUCTIONS.md`
   - ‚úÖ –°–∫—Ä–∏–ø—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å–æ–∑–¥–∞–Ω: `verify-migrations.ps1`
   - ‚úÖ –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∞: `supabase/config.toml`

## ‚è≥ –¢—Ä–µ–±—É–µ—Ç—Å—è –¥–µ–π—Å—Ç–≤–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

### –¢–µ–∫—É—â–∏–π —Å—Ç–∞—Ç—É—Å –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö:

```
‚ùå users              - –Ω–µ —Å–æ–∑–¥–∞–Ω–∞
‚ùå sessions           - –Ω–µ —Å–æ–∑–¥–∞–Ω–∞
‚ùå user_preferences   - –Ω–µ —Å–æ–∑–¥–∞–Ω–∞
‚ùå search_history     - –Ω–µ —Å–æ–∑–¥–∞–Ω–∞
‚ùå places_cache       - –Ω–µ —Å–æ–∑–¥–∞–Ω–∞
```

### –ü–æ—á–µ–º—É –º–∏–≥—Ä–∞—Ü–∏–∏ –Ω–µ –ø—Ä–∏–º–µ–Ω–µ–Ω—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏?

1. **Supabase CLI**: –ù–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –≥–ª–æ–±–∞–ª—å–Ω—É—é —É—Å—Ç–∞–Ω–æ–≤–∫—É —á–µ—Ä–µ–∑ npm
2. **Access Token**: –ò–º–µ—é—â–∏–π—Å—è —Ç–æ–∫–µ–Ω –Ω–µ –∏–º–µ–µ—Ç –ø—Ä–∞–≤ –Ω–∞ Management API
3. **REST API**: –ù–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω–æ–≥–æ SQL

### ‚úÖ –†–µ—à–µ–Ω–∏–µ: –†—É—á–Ω–æ–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ —á–µ—Ä–µ–∑ Dashboard

–≠—Ç–æ **—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –∏ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–π** —Å–ø–æ—Å–æ–± –¥–ª—è –ø–µ—Ä–≤–∏—á–Ω–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–æ–µ–∫—Ç–∞.

## üìã –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

### –®–∞–≥ 1: –ü—Ä–∏–º–µ–Ω–∏—Ç–µ –º–∏–≥—Ä–∞—Ü–∏–∏

–û—Ç–∫—Ä–æ–π—Ç–µ —Ñ–∞–π–ª `APPLY_MIGRATIONS_INSTRUCTIONS.md` –∏ —Å–ª–µ–¥—É–π—Ç–µ –ø–æ—à–∞–≥–æ–≤–æ–π –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏.

**–ö—Ä–∞—Ç–∫–∞—è –≤–µ—Ä—Å–∏—è:**
1. –û—Ç–∫—Ä–æ–π—Ç–µ https://app.supabase.com
2. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ SQL Editor
3. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –∏ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ SQL –∏–∑ –∫–∞–∂–¥–æ–≥–æ —Ñ–∞–π–ª–∞ –º–∏–≥—Ä–∞—Ü–∏–∏ (–≤ –ø–æ—Ä—è–¥–∫–µ 001‚Üí006)

### –®–∞–≥ 2: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç

–ü–æ—Å–ª–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –º–∏–≥—Ä–∞—Ü–∏–π –∑–∞–ø—É—Å—Ç–∏—Ç–µ:

```powershell
.\verify-migrations.ps1
```

–í—ã –¥–æ–ª–∂–Ω—ã —É–≤–∏–¥–µ—Ç—å:
```
[OK] Table 'users' exists
[OK] Table 'sessions' exists
[OK] Table 'user_preferences' exists
[OK] Table 'search_history' exists
[OK] Table 'places_cache' exists

SUCCESS! All tables have been created!
```

### –®–∞–≥ 3: –ü—Ä–æ–¥–æ–ª–∂–∏—Ç–µ —Ä–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏–µ

–ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –º–∏–≥—Ä–∞—Ü–∏–π:
- –†–∞–∑–≤–µ—Ä–Ω–∏—Ç–µ Edge Functions
- –ù–∞—Å—Ç—Ä–æ–π—Ç–µ Telegram webhook
- –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ –±–æ—Ç–∞

## üìö –ü–æ–ª–µ–∑–Ω—ã–µ —Å—Å—ã–ª–∫–∏

- **–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –º–∏–≥—Ä–∞—Ü–∏—è–º**: `APPLY_MIGRATIONS_INSTRUCTIONS.md`
- **–°–∫—Ä–∏–ø—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏**: `verify-migrations.ps1`
- **–†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –º–∏–≥—Ä–∞—Ü–∏—è–º**: `supabase/MIGRATIONS_GUIDE.md`
- **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è Supabase**: https://supabase.com/docs

## üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö (–ø–æ—Å–ª–µ –º–∏–≥—Ä–∞—Ü–∏–π)

| –¢–∞–±–ª–∏—Ü–∞ | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ | –ö–ª—é—á–µ–≤—ã–µ –ø–æ–ª—è |
|---------|-----------|---------------|
| `users` | –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ Telegram | user_id, telegram_username, created_at |
| `sessions` | –ö–æ–Ω—Ç–µ–∫—Å—Ç –¥–∏–∞–ª–æ–≥–∞ | session_id, user_id, current_location, last_query |
| `user_preferences` | –ü–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∞—Ü–∏—è | preference_id, home_location, dietary_restrictions |
| `search_history` | –ê–Ω–∞–ª–∏—Ç–∏–∫–∞ | search_id, query_text, returned_place_ids, user_rating |
| `places_cache` | –ö—ç—à Google Places | place_id, google_data_jsonb, cache_expires_at |

### –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- ‚úÖ Row Level Security (RLS) –≤–∫–ª—é—á–µ–Ω –Ω–∞ –≤—Å–µ—Ö —Ç–∞–±–ª–∏—Ü–∞—Ö
- ‚úÖ –ü–æ–ª–∏—Ç–∏–∫–∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã –¥–ª—è service_role
- ‚úÖ PostGIS —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ –¥–ª—è –≥–µ–æ–ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ–Ω–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤

### –ò–Ω–¥–µ–∫—Å—ã

–°–æ–∑–¥–∞–Ω—ã –∏–Ω–¥–µ–∫—Å—ã –¥–ª—è:
- –ë—ã—Å—Ç—Ä–æ–≥–æ –ø–æ–∏—Å–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- –ì–µ–æ–ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ–Ω–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ (GIST –∏–Ω–¥–µ–∫—Å—ã)
- –ê–Ω–∞–ª–∏—Ç–∏–∫–∏ –ø–æ –≤—Ä–µ–º–µ–Ω–∏
- –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –∫—ç—à–∞

---

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ**: –≠—Ç–æ—Ç –ø—Ä–æ—Ü–µ—Å—Å –Ω—É–∂–Ω–æ –≤—ã–ø–æ–ª–Ω–∏—Ç—å —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω —Ä–∞–∑ –ø—Ä–∏ –ø–µ—Ä–≤–æ–Ω–∞—á–∞–ª—å–Ω–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–µ –ø—Ä–æ–µ–∫—Ç–∞.

